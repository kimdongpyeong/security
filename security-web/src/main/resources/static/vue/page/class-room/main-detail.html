<el-container style="border: 1px solid #eee; margin: 0px !important;">
    <el-container v-if="room.type === 'R'" width="40%" style="margin: 0px !important;">
        <div style="width: 100%">
            <el-header style="padding: 0px; border: none;">
                <el-col v-if="noticeList.length>0 && noticeFlag">
                    <template v-if="noticeBoxFlag">
                      <el-alert
                        title="공지사항"
                        type="warning"
                        :description="noticeContent"
                        @close="closeNotice()">
                      </el-alert>
                    </template>
                    <template v-else>
                        <el-button type="warning" icon="el-icon-bell" circle  @click="openNotice()"></el-button>
                        <el-button v-if="currentUserId === room.createdBy"type="danger" icon="el-icon-delete" circle @click="removeNotice(noticeList[0])"></el-button>
                    </template>
                </el-col>
            </el-header>
            <el-main style="text-align: center; ">
                <template v-for="item in data.timeList">
                    <div style="width: 100%;">
                        {{item.title}}
                        <button type="button" class="main-btn" @click="goLiveMeeting(item.id);">줌 이동</button>
                    </div>
                </template>
                <br>
                <button type="button" class="main-btn" @click="goPersonalChat">1:1 채팅방 이동</button>
            </el-main>
        </div>
    </el-container>
    <!-- 채팅 -->
    <el-aside :width="room.type === 'R' ? '60%' : '100%'" style="margin: 0px !important;">
        <el-header v-if="room.type === 'N' && noticeList.length>0 && noticeFlag" style="padding: 0px; border: none;">
            <template v-if="noticeBoxFlag">
              <el-alert
                title="공지사항"
                type="warning"
                :description="noticeContent"
                @close="closeNotice()">
              </el-alert>
            </template>
            <template v-else>
                <el-button type="warning" icon="el-icon-bell" circle  @click="openNotice()"></el-button>
                <el-button v-if="currentUserId === room.createdBy"type="danger" icon="el-icon-delete" circle @click="removeNotice(noticeList[0])"></el-button>
            </template>
        </el-header>
        <div style="width: 100%;">
            <vue-advanced-chat
                :height="screenHeight"
                :current-user-id="currentUserId"
                :messages-loaded="messagesLoaded"
                :room-id="roomId"
                :rooms = "rooms"
                :rooms-loaded="roomsLoaded"
                :single-room="true"
                :menu-actions="menuActions"
                @menu-action-handler="menuActionHandler"
                @fetch-messages="fetchMessages"
                @send-message="sendMessage"
                @edit-message="editMessage"
                @delete-message="deleteMessage"
                @notice-message="noticeMessage"
                @open-file="openFile"/>
        </div>
    </el-aside>

    <!-- 친구 목록 -->
    <el-dialog title="친구 목록" :visible.sync="visible.userListVisible">
        <el-table :data="room.users" style="width: 100%">
            <el-table-column label="프로필" prop="avatar" align="center">
                <template slot-scope="scope">
                    <el-avatar size="small" :src="scope.row.avatar" @click.native="showProfile(scope.row)"/>
                </template>
            </el-table-column>
            <el-table-column label="이름" prop="username" align="center">
                <template slot-scope="scope">
                    {{ scope.row._id === room.createdBy ? "👑" + scope.row.username : scope.row.username}}
                </template>
            </el-table-column>
            <el-table-column align="center">
                <template slot-scope="scope">
                    <el-button v-if="scope.row._id === currentUserId" size="mini" @click="goMyPage()">마이페이지</el-button>
                    <el-button v-else-if="scope.row._id === room.createdBy || currentUserId === room.createdBy" size="mini" @click="userChat(scope.row._id, scope.row.username)">1:1채팅</el-button>
                </template>
            </el-table-column>
        </el-table>
    </el-dialog>

    <!-- 그룹채팅방 내 프로필사진 클릭 시, 뜨는 팝업 -->
    <div class="infoFormWrap">
        <el-dialog
            title="프로필보기"
            :visible.sync="store.state.app.chatProfile.flag"
            class="signUpWrap">
            <div class="contents">
                <div class="profileUpload">
                    <img
                        :src="data.other.profile"
                        alt="프로필 이미지"
                    />
                </div>
                <div class="nicknameBoxGroup" style="padding-top: 20px;text-align: center;">
                    <font style="font-size: large;" >{{data.other.name}}</font>
                </div>
            </div>
            <div class="btnWrap">
                <button type="button" v-if="data.other.id !== currentUserId && (data.other.id === room.createdBy || data.user.id === room.createdBy)" style="margin:0px" @click="userChat(data.other.id, data.other.name)">1:1 채팅하기</button>
                <button type="button" v-else-if="data.other.id === currentUserId" style="margin:0px" @click="goMyPage()">마이페이지</button>
            </div>
        </el-dialog>
    </div>
    <!-- 참여코드기재 팝업 -->
    <el-dialog
        :title = "enterClassRoom.title"
        width="30%"
        :visible.sync="visible.enterCodeVisible"
         :close-on-click-modal="false"
         :close-on-press-escape="false">
        <v-row>
            <v-col style="align-self: center;">
                <div style="text-align:center;">
                    <font>초대코드가 필요합니다.<p>🔑초대코드를 입력해주세요🔑</font><p>
                    <el-input
                        style="border-bottom: double;
                        inline-size: max-content;"
                        placeholder="4자리 코드를 입력해주세요"
                        maxlength="4"
                        v-model="codeCk"
                        show-password>
                    </el-input>
                </div>
            </v-col>
        </v-row>
      <span slot="footer" class="dialog-footer">
        <el-button @click="visible.enterCodeVisible = false">취소</el-button>
        <el-button type="primary" @click="enterCode();">확인</el-button>
      </span>
    </el-dialog>
</el-container>